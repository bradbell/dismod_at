<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Changes and Additions to Dismod_at During 2021</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Changes and Additions to Dismod_at During 2021">
<meta name="keywords" id="keywords" content=" changes additions to dismod_at during 2021 06-07 06-06 06-01 05-31 05-29 05-21 05-20 05-19 05-18 05-15 05-07 05-06 04-16 03-02 01-28 01-22 01-21 01-19 01-11 01-10 01-09 01-08 ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_whats_new_2021_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://bradbell.github.io/dismod_at" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Location-&gt;</option>
<option>dismod_at</option>
<option>release_notes</option>
<option>whats_new_2021</option>
</select>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Search-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td><a href="release_notes.htm" target="_top">Prev</a>
</td><td><a href="whats_new_2020.htm" target="_top">Next</a>
</td><td>
<script type='text/javascript' language='JavaScript' src='_childtable_dismod_at_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_release_notes_htm.js'></script>
</td>
<td>whats_new_2021</td>
<td>
<select onchange='choose_current0(this)'>
<option>Heading-&gt;</option>
<option>06-07</option>
<option>06-06</option>
<option>06-01</option>
<option>05-31</option>
<option>05-29</option>
<option>05-21</option>
<option>05-20</option>
<option>05-19</option>
<option>05-18</option>
<option>05-15</option>
<option>05-07</option>
<option>05-06</option>
<option>04-16</option>
<option>03-02</option>
<option>01-28</option>
<option>01-22</option>
<option>01-21</option>
<option>01-19</option>
<option>01-11</option>
<option>01-10</option>
<option>01-09</option>
<option>01-08</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@



<center><b><big><big>Changes and Additions to Dismod_at During 2021</big></big></b></center>
<br>
<b><big><a name="06-07" id="06-07">06-07</a></big></b>
<br>
Add a discussion heading at the top of <a href="database.htm" target="_top"><span style='white-space: nowrap'>database</span></a>
 sections
that did not have a heading after the jump table at the top of the section;
e.g., the covariate table
<a href="covariate_table.htm#Discussion" target="_top"><span style='white-space: nowrap'>discussion</span></a>
 heading.

<br>
<br>
<b><big><a name="06-06" id="06-06">06-06</a></big></b>
<br>
Advance to cppad_mixed-20210606.
This enable adding the <a href="fixed_trace_table.htm" target="_top"><span style='white-space: nowrap'>fixed_trace_table</span></a>
,
for an example usage; see
<a href="user_warm_start.py.htm#Fixed Trace Table" target="_top"><span style='white-space: nowrap'>fixed&nbsp;trace&nbsp;table</span></a>

in the warm start example.

<br>
<br>
<b><big><a name="06-01" id="06-01">06-01</a></big></b>
<br>
The <a href="fit_command.htm#warm_start" target="_top"><span style='white-space: nowrap'>warm_start</span></a>
 option was added
to the fit command.
This is much better than just modifying the
<a href="start_var_table.htm" target="_top"><span style='white-space: nowrap'>start_var_table</span></a>
 because it also sets the initial Lagrange multipliers.
For an example, see <a href="user_warm_start.py.htm" target="_top"><span style='white-space: nowrap'>user_warm_start.py</span></a>
.

<br>
<br>
<b><big><a name="05-31" id="05-31">05-31</a></big></b>
<br>
Advance to cppad_mixed-20210531.
This is in preparation for adding a warm start option to the fit command.

<br>
<br>
<b><big><a name="05-29" id="05-29">05-29</a></big></b>

<ol type="1"><li>
Advance to cppad_mixed-20210528.
This speeds up and improves the <code><font color="blue">adaptive</font></code>
<a href="option_table.htm#Fixed and Random.derivative_test" target="_top"><span style='white-space: nowrap'>derivative_test</span></a>
.
It also improves the checking of bounds, complementarity, and
the gradient of the Lagrangian at the final solution.
It also improves the detection of when Lagrangian multipliers should be
non-zero because a constraint is active; e.g., see
<a href="fit_var_table.htm#lagrange_value" target="_top"><span style='white-space: nowrap'>lagrange_value</span></a>
 in the
fit_var table.
</li><li>

The new version of cppad_mixed found identifiability problems with the
<a href="user_subgroup_mulcov.py.htm" target="_top"><span style='white-space: nowrap'>user_subgroup_mulcov.py</span></a>
 example.
This has been fixed by change the prior for the child and subgroup
random effect from uniform to a very broad Gaussian.
</li></ol>


<br>
<br>
<b><big><a name="05-21" id="05-21">05-21</a></big></b>

<ol type="1"><li>
Advance to <a href="dock_dismod_at.sh.htm" target="_top"><span style='white-space: nowrap'>dock_dismod_at.sh</span></a>
 version 20210416.
Building this new image will require executing
<pre style='display:inline'><tt>
     <font color="#990000">.</font>/dock_dismod_at image mixed
     <font color="#990000">.</font>/dock_dismod_at image dismod_at
</tt></pre>
The <a href="dock_dismod_at.sh.htm#Building Images.dismod_at.mixed" target="_top"><span style='white-space: nowrap'>dismod_at.mixed</span></a>

image is necessary because the version of cppad-mixed has changed since
the last advancement of dock_dismod_at.sh.
</li><li>

In the <code><font color="blue">user_data_sim_py</font></code> example the code
<pre style='display:inline'><tt>
     residual <font color="#990000">=</font> <font color="#990000">(</font>math<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>z <font color="#990000">+</font> eta <font color="#990000">+</font> delta<font color="#990000">)</font> <font color="#990000">-</font> math<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>mu <font color="#990000">+</font> eta<font color="#990000">))</font> <font color="#990000">/</font> sigma
</tt></pre>
was incorrect and was changed to
<pre style='display:inline'><tt>
     residual <font color="#990000">=</font> <font color="#990000">(</font>math<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>z <font color="#990000">+</font> eta<font color="#990000">)</font> <font color="#990000">-</font> math<font color="#990000">.</font><b><font color="#000000">log</font></b><font color="#990000">(</font>mu <font color="#990000">+</font> eta<font color="#990000">))</font> <font color="#990000">/</font> sigma
</tt></pre>
</li><li>
Change the default setting for
<a href="user_diabetes.py.htm#Problem Parameters.quasi_fixed" target="_top"><span style='white-space: nowrap'>quasi_fixed</span></a>

from <code><font color="blue">'true'</font></code> to <code><font color="blue">'false'</font></code>.
</li><li>

Change <a href="user_fit_sim.py.htm" target="_top"><span style='white-space: nowrap'>user_fit_sim.py</span></a>
 
<code><i><font color="black"><span style='white-space: nowrap'>quasi_newton</span></font></i></code>
 setting from
<code><font color="blue">'true'</font></code> to <code><font color="blue">'false'</font></code> and make the maximum allowable error
smaller.
</li></ol>


<br>
<br>
<b><big><a name="05-20" id="05-20">05-20</a></big></b>
 <br>
During a <a href="simulate_command.htm" target="_top"><span style='white-space: nowrap'>simulate_command</span></a>
,
the calculation of <code><font color="blue">data_sim_delta</font></code> and <code><font color="blue">data_sim_stdcv</font></code> in the
<a href="data_sim_table.htm" target="_top"><span style='white-space: nowrap'>data_sim_table</span></a>
 often resulted in zero or negative values
which does not make sense and would cause dismod_at to abort with the message

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>...</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;simulate_command&nbsp;sim_stdcv&nbsp;is&nbsp;nan&nbsp;or&nbsp;less&nbsp;than&nbsp;zero&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>...</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
This problem has been fixed using
<a href="data_like.htm#Adjusted Standard Deviation, delta_i(theta)" target="_top"><span style='white-space: nowrap'>adjusted&nbsp;standard&nbsp;deviation</span></a>

to replace 
<code><i><font color="black"><span style='white-space: nowrap'>data_sim_delta</span></font></i></code>
 and
<a href="data_like.htm#Notation.Minimum CV Standard Deviation, Delta_i" target="_top"><span style='white-space: nowrap'>minimum&nbsp;CV&nbsp;standard&nbsp;deviation</span></a>

to replace 
<code><i><font color="black"><span style='white-space: nowrap'>data_sim_stdcv</span></font></i></code>
.
These replacements use the original measurements
<a href="data_table.htm#meas_value" target="_top"><span style='white-space: nowrap'>meas_value</span></a>

instead of the simulated measurements
<a href="data_sim_table.htm#data_sim_value" target="_top"><span style='white-space: nowrap'>data_sim_value</span></a>

to define the corresponding
<a href="data_like.htm#Transformed Standard Deviation, sigma_i(theta)" target="_top"><span style='white-space: nowrap'>transformed&nbsp;standard&nbsp;deviation</span></a>
.
<ol type="1"><li>
Add the <a href="user_sim_log.py.htm" target="_top"><span style='white-space: nowrap'>user_sim_log.py</span></a>
 example to highlight this change.
</li><li>

Adapt the <a href="user_data_sim.py.htm" target="_top"><span style='white-space: nowrap'>user_data_sim.py</span></a>
 examples to this change.
</li><li>

<b>API Change</b>:
The <code><font color="blue">data_sim_delta</font></code> and <code><font color="blue">data_sim_stdcv</font></code> columns
were removed from the <a href="data_sim_table.htm" target="_top"><span style='white-space: nowrap'>data_sim_table</span></a>
.
The <code><font color="blue">sim_stdcv</font></code> and <code><font color="blue">sim_delta</font></code> columns
were removed from the <a href="db2csv_command.htm#data.csv" target="_top"><span style='white-space: nowrap'>data.csv</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="05-19" id="05-19">05-19</a></big></b>
<br>
Add missing source code in the documentation for the
<a href="user_covid_19.py.htm#Source Code" target="_top"><span style='white-space: nowrap'>covid_19.py</span></a>
 and
<a href="user_residual.py.htm#Source Code" target="_top"><span style='white-space: nowrap'>residual.py</span></a>
 examples.

<br>
<br>
<b><big><a name="05-18" id="05-18">05-18</a></big></b>
<br>
Advance to cppad_mixed-20210517.
This change, and changes to dismod_at, catch and report throws of <code><font color="blue">std::exception</font></code>
both in the output and in the <a href="log_table.htm" target="_top"><span style='white-space: nowrap'>log_table</span></a>
.

<br>
<br>
<b><big><a name="05-15" id="05-15">05-15</a></big></b>
<br>
Advance to cppad_mixed-20210515.
This avoids running the cppad_mixed tests during
<a href="example_install.sh.htm" target="_top"><span style='white-space: nowrap'>example_install.sh</span></a>
.
It also fixes a problem with the optimization of cppad function objects.

<br>
<br>
<b><big><a name="05-07" id="05-07">05-07</a></big></b>
<br>
Advance to cppad_mixed-20210507. This should solve some install problems
on the msys and cygwin systems.

<br>
<br>
<b><big><a name="05-06" id="05-06">05-06</a></big></b>
<br>
If a <a href="db2csv_command.htm#data.csv.meas_delta" target="_top"><span style='white-space: nowrap'>meas_delta</span></a>
,
in the <code><font color="blue">data.csv</font></code> created by <code><font color="blue">db2csv</font></code> command,
is greater than the maximum python <code><font color="blue">float</font></code>, report it as empty.

<br>
<br>
<b><big><a name="04-16" id="04-16">04-16</a></big></b>

<ol type="1"><li>
The <a href="fit_command.htm#variables.both" target="_top"><span style='white-space: nowrap'>fit&nbsp;both</span></a>
 command was failing when
<a href="option_table.htm#zero_sum_child_rate" target="_top"><span style='white-space: nowrap'>zero_sum_child_rate</span></a>

was specified for a rate that did not have any children.
This has been fixed.
</li><li>

There was a syntax error in the <code><font color="blue">test/user/fit_sim.py</font></code> program.
This has been fixed.
</li><li>

Advance to <a href="dock_dismod_at.sh.htm" target="_top"><span style='white-space: nowrap'>dock_dismod_at.sh</span></a>
 version 20210416.
This includes the bug fix above.
</li></ol>


<br>
<br>
<b><big><a name="03-02" id="03-02">03-02</a></big></b>
<br>
Advance to cppad_mixed-20210302.
This places the release source directories Ipopt.git, Mumps.git, ASL.git in
<code><font color="blue">external/release/cppad_mixed/external</font></code> (similarly for the debug case).
Previously Mumps.git  was below ASL.git and
Ipopt.git was below Mumps.git.

<br>
<br>
<b><big><a name="01-28" id="01-28">01-28</a></big></b>
<br>
Advance to <a href="dock_dismod_at.sh.htm" target="_top"><span style='white-space: nowrap'>dock_dismod_at.sh</span></a>
 version 20210128.
Most importantly this includes the new 
<code><i><font color="black"><span style='white-space: nowrap'>meas_noise_effect</span></font></i></code>
 options
added on <a href="whats_new_2021.htm#01-10" target="_top"><span style='white-space: nowrap'>01-10</span></a>
.
For those at IHME, it is also has the new <code><font color="blue">fit_ihme.py</font></code> program.

<br>
<br>
<b><big><a name="01-22" id="01-22">01-22</a></big></b>
<br>
The <a href="set_command.htm" target="_top"><span style='white-space: nowrap'>set</span></a>
 <code><font color="blue">option</font></code> command
no longer requires the option table it to be consistent with all the
other <a href="input.htm" target="_top"><span style='white-space: nowrap'>input</span></a>
 tables.
It only has to be self consistent.
This enables one to use the <code><font color="blue">set option</font></code> command to change the
<a href="option_table.htm#rate_case" target="_top"><span style='white-space: nowrap'>rate_case</span></a>
 to a value
that is consistent with the rest of the database.


<br>
<br>
<b><big><a name="01-21" id="01-21">01-21</a></big></b>
<br>
The program <code><font color="blue">db_simplify</font></code> was changed to
<code><font color="blue">fit_ihme.py</font></code> because it fits ihme databases.
It now gets installed and is part of the User API.
You can use it, if you have access to the ihme databases,
but it is not part of this documentation (specifications).
If you execute <code><font color="blue">fit_ihme.py</font></code> with no arguments,
you will get a usage message that give you some idea how to use it.

<br>
<br>
<b><big><a name="01-19" id="01-19">01-19</a></big></b>
<br>
The file name was removed from the log table entry at the
<a href="dismodat.py.htm#Log Table.Start" target="_top"><span style='white-space: nowrap'>start</span></a>

of a <code><font color="blue">dismodat.py</font></code> command.
This is so that all log messages with
<a href="log_table.htm#message_type" target="_top"><span style='white-space: nowrap'>message_type</span></a>
 <code><font color="blue">command</font></code>
start with <code><font color="blue">begin</font></code> and then the name of the command.

<br>
<br>
<b><big><a name="01-11" id="01-11">01-11</a></big></b>
<br>
Change the order of the columns in the file
<a href="db2csv_command.htm#variable.csv" target="_top"><span style='white-space: nowrap'>variable.csv</span></a>
 so that
the fit results
<a href="db2csv_command.htm#variable.csv.fit_value" target="_top"><span style='white-space: nowrap'>fit_value</span></a>

are next to the corresponding lower and upper limits.

<br>
<br>
<b><big><a name="01-10" id="01-10">01-10</a></big></b>

<ol type="1"><li>
The <a href="user_data_sim.py.htm" target="_top"><span style='white-space: nowrap'>user_data_sim.py</span></a>
 example was changed so that it uses
the same notation as the new version of the
<a href="data_sim_table.htm" target="_top"><span style='white-space: nowrap'>data_sim_table</span></a>
 documentation and tests more cases.
</li><li>

The bug fix of the value of 
<code><i><font color="black"><span style='white-space: nowrap'>data_sim_stdcv</span></font></i></code>
 on 01-09
was corrected (better testing show it was incorrect).
</li><li>

Add following <a href="option_table.htm#meas_noise_effect" target="_top"><span style='white-space: nowrap'>meas_noise_effect</span></a>
 cases:
<a href="data_like.htm#Adjusted Standard Deviation, delta_i(theta).add_std_scale_none" target="_top"><span style='white-space: nowrap'>add_std_scale_none</span></a>
,
<a href="data_like.htm#Adjusted Standard Deviation, delta_i(theta).add_var_scale_none" target="_top"><span style='white-space: nowrap'>add_var_scale_none</span></a>
.
</li></ol>



<br>
<br>
<b><big><a name="01-09" id="01-09">01-09</a></big></b>

<ol type="1"><li>
The documentation for the <a href="data_sim_table.htm" target="_top"><span style='white-space: nowrap'>data_sim_table</span></a>
 was improved.
</li><li>

Fix a bug in the value of the data_sim table column 
<code><i><font color="black"><span style='white-space: nowrap'>data_sim_stdcv</span></font></i></code>

when <a href="option_table.htm#meas_noise_effect" target="_top"><span style='white-space: nowrap'>meas_noise_effect</span></a>
 is
<code><font color="blue">add_var_scale_log</font></code> and the density is
<a href="density_table.htm#Notation.Linear" target="_top"><span style='white-space: nowrap'>linear</span></a>
.
</li></ol>


<br>
<br>
<b><big><a name="01-08" id="01-08">01-08</a></big></b>

<ol type="1"><li>
The definition of the transformed standard deviation <small>@(@
\sigma
@)@</small>
was extended to apply to all densities, not just
<a href="density_table.htm#Notation.Log Scaled" target="_top"><span style='white-space: nowrap'>log&nbsp;scaled</span></a>
 densities.
In addition, the definition was move from the <a href="statistic.htm" target="_top"><span style='white-space: nowrap'>statistic</span></a>
 section
to a place where the different cases are easier to understand; see

<code><i><font color="black"><span style='white-space: nowrap'>sigma</span></font></i></code>
 in
<a href="data_like.htm#Transformed Standard Deviation, sigma_i(theta)" target="_top"><span style='white-space: nowrap'>data_like</span></a>
,
<a href="fixed_value.htm#sigma_j" target="_top"><span style='white-space: nowrap'>fixed_value</span></a>
,
<a href="random_value.htm#sigma_j" target="_top"><span style='white-space: nowrap'>random_value</span></a>
,
<a href="smooth_dage.htm#sigma_ij" target="_top"><span style='white-space: nowrap'>smooth_dage</span></a>
,
<a href="smooth_dtime.htm#sigma_ij" target="_top"><span style='white-space: nowrap'>smooth_dtime</span></a>
.
</li><li>

In the definition of the value prior for the random effects
<a href="random_value.htm#V_j^u" target="_top"><span style='white-space: nowrap'>V_j^u</span></a>
 the term
<small>@[@

D \left( \theta_j \W{,} \mu_j \W{,} \lambda_j \sigma_j \W{,} d_j \right)

@]@</small>
was corrected to be
<small>@[@

D \left( u_j \W{,} \mu_j \W{,} \lambda_j \sigma_j \W{,} d_j \right)

@]@</small>
</li></ol>





<hr>Input File: omh/whats_new/2021.omh

</body>
</html>
