<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>The Censored Gaussian and Laplace Densities</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="The Censored Gaussian and Laplace Densities">
<meta name="keywords" id="keywords" content=" the censored gaussian laplace densities under construction reference discussion simulation test density g(ymudelta) error function g(ymudeltac) difference between means l(ymudelta) indefinite integral l(ymudeltac) ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_censor_density_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://bradbell.github.io/dismod_at" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Location-&gt;</option>
<option>dismod_at</option>
<option>math_abstract</option>
<option>censor_density</option>
</select>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Search-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td><a href="math_ode.htm" target="_top">Prev</a>
</td><td><a href="install_unix.htm" target="_top">Next</a>
</td><td>
<script type='text/javascript' language='JavaScript' src='_childtable_dismod_at_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_math_abstract_htm.js'></script>
</td>
<td>censor_density</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@


<center><b><big><big>The Censored Gaussian and Laplace Densities</big></big></b></center>

<br><a href="censor_density.htm#Under Construction" target="_top">Under&nbsp;Construction</a>
<br><a href="censor_density.htm#Reference" target="_top">Reference</a>
<br><a href="censor_density.htm#Discussion" target="_top">Discussion</a>
<br><a href="censor_density.htm#Simulation Test" target="_top">Simulation&nbsp;Test</a>
<br><a href="censor_density.htm#Gaussian" target="_top">Gaussian</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Gaussian.Density, G(y,mu,delta)" target="_top">Density,&nbsp;G(y,mu,delta)</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Gaussian.Error Function" target="_top">Error&nbsp;Function</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Gaussian.Censored Density, G(y,mu,delta,c)" target="_top">Censored&nbsp;Density,&nbsp;G(y,mu,delta,c)</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Gaussian.Difference Between Means" target="_top">Difference&nbsp;Between&nbsp;Means</a>
<br><a href="censor_density.htm#Laplace" target="_top">Laplace</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Laplace.Density, L(y,mu,delta)" target="_top">Density,&nbsp;L(y,mu,delta)</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Laplace.Indefinite Integral" target="_top">Indefinite&nbsp;Integral</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Laplace.Censored Density, L(y,mu,delta,c)" target="_top">Censored&nbsp;Density,&nbsp;L(y,mu,delta,c)</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="censor_density.htm#Laplace.Difference Between Means" target="_top">Difference&nbsp;Between&nbsp;Means</a>
<br><br>
<b><big><a name="Under Construction" id="Under Construction">Under Construction</a></big></b>
<br>
This is a plan for censored distribution functions,
but they have not yet been implemented.

<br>
<br>
<b><big><a name="Reference" id="Reference">Reference</a></big></b>
<br>
See the heading
<i>Likelihoods for mixed continuous-discrete distributions</i>
on the
<a href="https://en.wikipedia.org/wiki/Likelihood_function" target="_top"><span style='white-space: nowrap'>wiki&nbsp;page</span></a>

for likelihood functions.

<br>
<br>
<b><big><a name="Discussion" id="Discussion">Discussion</a></big></b>
<br>
We use <small>@(@
\mu
@)@</small> for the mean and
<small>@(@
\delta > 0
@)@</small> for the standard deviation
of a Gaussian or Laplace random variable <small>@(@
y
@)@</small>.
We use <small>@(@
c \leq \mu
@)@</small> for the value we are
censoring the random variable at.
The censored random variable is defined by
<small>@[@

\underline{y} = \left\{ \begin{array}{ll}
	c & \R{if} \; y \leq c
	\\
	y & \R{otherwise}
\end{array} \right.

@]@</small>
The crucial property is that the
censored density functions (defined below)
are smooth function with respect to the mean value <small>@(@
\mu
@)@</small>
(but not even continuous with respect to <small>@(@
c
@)@</small> or <small>@(@
y
@)@</small>).

<br>
<br>
<b><big><a name="Simulation Test" id="Simulation Test">Simulation Test</a></big></b>
<br>
The file <code><font color="blue">test/user/censor_density.py</font></code> contains a test
of maximum likelihood estimation using the continuous-discrete densities
proposed below.

<br>
<br>
<b><big><a name="Gaussian" id="Gaussian">Gaussian</a></big></b>


<br>
<br>
<big><a name="Gaussian.Density, G(y,mu,delta)" id="Gaussian.Density, G(y,mu,delta)">Density, G(y,mu,delta)</a></big>
<br>
The Gaussian density function is given by
<small>@[@

G( y , \mu , \delta )
=
\sqrt{ \frac{1}{ 2 \pi \delta^2 } }
\exp \left[ - \frac{1}{2} \left( \frac{y - \mu}{\delta} \right)^2 \right]

@]@</small>

<br>
<br>
<big><a name="Gaussian.Error Function" id="Gaussian.Error Function">Error Function</a></big>
<br>
The Error function is defined (for <small>@(@
0 \leq x
@)@</small>) by
<small>@[@

\R{erf}(x)
=
\sqrt{ \frac{1}{\pi} } \int_{-x}^{+x} \exp \left( - t^2 \right) \; \R{d} t

@]@</small>
Using he change of variables <small>@(@
t = \sqrt{2}^{-1} (y - \mu) / \delta )
@)@</small>
we have <small>@(@
y = \mu + t \delta \sqrt{2}
@)@</small> and
<small>@[@

\R{erf}(x)
=
\sqrt{ \frac{1}{2 \pi \delta^2} }
\int_{\mu - x \delta \sqrt{2}}^{\mu + x \delta \sqrt{2}}
\exp \left[ - \frac{1}{2} \left( \frac{y - \mu}{\delta} \right)^2 \right]
\; \R{d} y

@]@</small>
Setting <small>@(@
x = \sqrt{2}^{-1} ( \mu - c ) / \delta
@)@</small> we obtain
<small>@[@

\R{erf}\left( \sqrt{2}^{-1} ( \mu - c ) / \delta \right)
=
\sqrt{ \frac{1}{2 \pi \delta^2} }
\int_{c}^{2 \mu - c}
\exp \left[ - \frac{1}{2} \left( \frac{y - \mu}{\delta} \right)^2 \right]
\; \R{d} y

@]@</small>
using the fact the Gaussian density is symmetric about the value
<small>@(@
y = \mu
@)@</small>, and its integral from minus infinity to plus infinity is one,
we obtain
<small>@[@

\frac{
	1 - \R{erf}\left( \sqrt{2}^{-1} ( \mu - c ) / \delta \right)
}{2}
=
\sqrt{ \frac{1}{2 \pi \delta^2} }
\int_{-\infty}^{c}
\exp \left[ - \frac{1}{2} \left( \frac{y - \mu}{\delta} \right)^2 \right]
\; \R{d} y

@]@</small>


<br>
<br>
<big><a name="Gaussian.Censored Density, G(y,mu,delta,c)" id="Gaussian.Censored Density, G(y,mu,delta,c)">Censored Density, G(y,mu,delta,c)</a></big>
<br>
The censored Gaussian density is defined by
<small>@[@

G ( \underline{y} , \mu , \delta , c )
=
\left\{ \begin{array}{ll}
\left( 1 - \R{erf}\left( \sqrt{2}^{-1} (\mu - c) / \delta  \right) \right) / 2
& \R{if} \; \underline{y} = c
\\
G( \underline{y} , \mu , \delta )  & \R{otherwise}
\end{array} \right.

@]@</small>
This density function is with respect to the
Lebesgue measure plus an atom with mass one at <small>@(@
\underline{y} = c
@)@</small>.

<br>
<br>
<big><a name="Gaussian.Difference Between Means" id="Gaussian.Difference Between Means">Difference Between Means</a></big>
<br>
We use <small>@(@
\overline{\underline{y}}
@)@</small> to
denote the mean after censoring the distribution:
<small>@[@

\frac{ \overline{\underline{y}} - \mu }{ \delta }
=
\frac{c - \mu}{2 \delta }
\left( 1 - \R{erf}\left( \sqrt{2}^{-1} (\mu - c) / \delta  \right) \right)
+
\sqrt{ \frac{1}{ 2 \pi \delta^2 } }
\int_c^{+\infty} \frac{y - \mu}{ \delta }
 \exp \left[ - \frac{1}{2} \left( \frac{y - \mu}{\delta} \right)^2 \right]
\; \R{d} y

@]@</small>
<small>@[@

\frac{ \overline{\underline{y}} - \mu }{ \delta }
=
\frac{c - \mu}{2 \delta }
\left( 1 - \R{erf}\left( \sqrt{2}^{-1} (\mu - c) / \delta  \right) \right)
-
\sqrt{ \frac{1}{ 2 \pi \delta^2 } }
\left[
 \exp \left( - \frac{1}{2} \left[ \frac{y - \mu}{\delta} \right]^2 \right)
\right]_c^{+\infty}

@]@</small>
<small>@[@

\overline{\underline{y}} - \mu
=
\frac{c - \mu}{2}
\left( 1 - \R{erf}\left( \sqrt{2}^{-1} (\mu - c) / \delta  \right) \right)
+
\sqrt{ \frac{1}{ 2 \pi } }
 \exp \left( - \frac{1}{2} \left[ \frac{c - \mu}{\delta} \right]^2 \right)

@]@</small>

<br>
<br>
<b><big><a name="Laplace" id="Laplace">Laplace</a></big></b>


<br>
<br>
<big><a name="Laplace.Density, L(y,mu,delta)" id="Laplace.Density, L(y,mu,delta)">Density, L(y,mu,delta)</a></big>
<br>
The Laplace density function is given by
<small>@[@

L( y , \mu , \delta )
=
\sqrt{ \frac{1}{2 \delta^2 } }
\exp \left[ - \sqrt{2} \left| \frac{y - \mu}{\delta} \right| \right]

@]@</small>

<br>
<br>
<big><a name="Laplace.Indefinite Integral" id="Laplace.Indefinite Integral">Indefinite Integral</a></big>
<br>
The indefinite integral with respect to <small>@(@
y
@)@</small>,
for <small>@(@
x \leq \mu
@)@</small>, is
<small>@[@

\int_{-\infty}^{x} L( y , \mu , \delta ) \; \R{d} y
=
\sqrt{ \frac{1}{2 \delta^2 } }
\int_{-\infty}^{x}
\exp \left( - \sqrt{2} \frac{\mu - y}{\delta} \right) \; \R{d} y

@]@</small>
Using <small>@(@
c \leq \mu
@)@</small>, we obtain
<small>@[@

\int_{-\infty}^{c} L( y , \mu , \delta ) \; \R{d} y
=
\frac{1}{2}
\exp \left( - \sqrt{2} \frac{\mu - c}{\delta} \right)

@]@</small>

<br>
<br>
<big><a name="Laplace.Censored Density, L(y,mu,delta,c)" id="Laplace.Censored Density, L(y,mu,delta,c)">Censored Density, L(y,mu,delta,c)</a></big>
<br>
The censored Laplace density is defined by
<small>@[@

L ( \underline{y} , \mu , \delta , c )
=
\left\{ \begin{array}{ll}
(1 / 2 )
\exp \left( - ( \mu - c ) \sqrt{2} / \delta \right)
	& \R{if} \; \underline{y} = c
	\\
	L( \underline{y} , \mu , \delta )
	& \R{otherwise}
\end{array} \right.

@]@</small>
This density function is with respect to the
Lebesgue measure plus an atom with mass one at <small>@(@
\underline{y} = c
@)@</small>.

<br>
<br>
<big><a name="Laplace.Difference Between Means" id="Laplace.Difference Between Means">Difference Between Means</a></big>
<br>
We use <small>@(@
\overline{\underline{y}}
@)@</small> to
denote the mean after censoring the distribution:
<small>@[@

\frac{ \overline{\underline{y}} - \mu }{ \delta }
=
\frac{c - \mu}{2 \delta }
\exp \left( - \sqrt{2} \frac{\mu - c}{\delta} \right)
+
\sqrt{ \frac{1}{2 \delta^2 } }
\int_c^{+\infty} \frac{y - \mu}{\delta}
\exp \left[ - \sqrt{2} \left| \frac{y - \mu}{\delta} \right| \right]
\; \R{d} y

@]@</small>
Using integration by parts,
one can obtain a formula for <small>@(@
\overline{\underline{y}} - \mu
@)@</small>
in a manner similar to calculation of the
<a href="censor_density.htm#Gaussian.Difference Between Means" target="_top"><span style='white-space: nowrap'>difference&nbsp;between&nbsp;means</span></a>

for the Gaussian case.


<hr>Input File: omh/math/censor_density.omh

</body>
</html>
