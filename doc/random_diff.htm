<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Random Effects Difference Density Function</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Random Effects Difference Density Function">
<meta name="keywords" id="keywords" content=" random effects difference density function k c i(k) j(k) lambda_k u_ijkc delta_ijk d_ijk mu_ijk age differences a^u time t^u ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_random_diff_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://bradbell.github.io/dismod_at" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Location-&gt;</option>
<option>dismod_at</option>
<option>model</option>
<option>random_diff</option>
</select>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Search-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td><a href="random_value.htm" target="_top">Prev</a>
</td><td><a href="random_prior.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_down2(this)'>
<option>dismod_at-&gt;</option>
<option>math_abstract</option>
<option>install_unix</option>
<option>get_started</option>
<option>user</option>
<option>database</option>
<option>model</option>
<option>command</option>
<option>python</option>
<option>devel</option>
<option>whats_new_2019</option>
<option>wish_list</option>
</select>
</td>
<td>
<select onchange='choose_down1(this)'>
<option>model-&gt;</option>
<option>model_variables</option>
<option>avg_integrand</option>
<option>data_like</option>
<option>fixed_value</option>
<option>fixed_diff</option>
<option>fixed_prior</option>
<option>random_value</option>
<option>random_diff</option>
<option>random_prior</option>
<option>statistic</option>
<option>bilinear</option>
<option>ode_grid</option>
<option>posterior</option>
<option>prev_dep</option>
<option>numeric_average</option>
</select>
</td>
<td>random_diff</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@


<center><b><big><big>Random Effects Difference Density Function</big></big></b></center>

<br><a href="random_diff.htm#k, K" target="_top">k,&nbsp;K</a>
<br><a href="random_diff.htm#C" target="_top">C</a>
<br><a href="random_diff.htm#I(k)" target="_top">I(k)</a>
<br><a href="random_diff.htm#J(k)" target="_top">J(k)</a>
<br><a href="random_diff.htm#lambda_k" target="_top">lambda_k</a>
<br><a href="random_diff.htm#u_i,j,k,c" target="_top">u_i,j,k,c</a>
<br><a href="random_diff.htm#delta_i,j,k" target="_top">delta_i,j,k</a>
<br><a href="random_diff.htm#d_i,j,k" target="_top">d_i,j,k</a>
<br><a href="random_diff.htm#mu_i,j,k" target="_top">mu_i,j,k</a>
<br><a href="random_diff.htm#Age Differences" target="_top">Age&nbsp;Differences</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="random_diff.htm#Age Differences.A^u" target="_top">A^u</a>
<br><a href="random_diff.htm#Time Differences" target="_top">Time&nbsp;Differences</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="random_diff.htm#Time Differences.T^u" target="_top">T^u</a><br>
<br>
<b><big><a name="k, K" id="k, K">k, K</a></big></b>
<br>
We use <small>@(@
k
@)@</small> to denote a
<a href="rate_table.htm#rate_id" target="_top"><span style='white-space: nowrap'>rate_id</span></a>

and <small>@(@
K
@)@</small> for the number of rates.

<br>
<br>
<b><big><a name="C" id="C">C</a></big></b>
<br>
We use <small>@(@
C
@)@</small> to denote the size of the
<a href="node_table.htm#parent.Child Group" target="_top"><span style='white-space: nowrap'>child&nbsp;group</span></a>

corresponding to the
<a href="option_table.htm#parent_node_id" target="_top"><span style='white-space: nowrap'>parent_node_id</span></a>
.
For <small>@(@
c = 0 , \ldots , C-1
@)@</small>, we use
<small>@(@
c
@)@</small> to denote the corresponding child.

<br>
<br>
<b><big><a name="I(k)" id="I(k)">I(k)</a></big></b>
<br>
We use <small>@(@
I(k)
@)@</small> to denote the number of age points
in the smoothing with index <small>@(@
k
@)@</small>.

<br>
<br>
<b><big><a name="J(k)" id="J(k)">J(k)</a></big></b>
<br>
We use <small>@(@
J(k)
@)@</small> to denote the number of time points
in the smoothing with index <small>@(@
k
@)@</small>.

<br>
<br>
<b><big><a name="lambda_k" id="lambda_k">lambda_k</a></big></b>
<br>
We use
<small>@(@
\lambda_k^a
@)@</small>
( <small>@(@
\lambda_k^t
@)@</small> )
to denote the
<a href="smooth_table.htm#mulstd_dage_prior_id" target="_top"><span style='white-space: nowrap'>mulstd_dage_prior_id</span></a>

( <a href="smooth_table.htm#mulstd_dtime_prior_id" target="_top"><span style='white-space: nowrap'>mulstd_dtime_prior_id</span></a>
 )
for the
<a href="rate_table.htm#child_smooth_id" target="_top"><span style='white-space: nowrap'>child_smooth_id</span></a>

corresponding to

<code><i><font color="black"><span style='white-space: nowrap'>rate_id</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>k</span></font></i></code>


<br>
<br>
<b><big><a name="u_i,j,k,c" id="u_i,j,k,c">u_i,j,k,c</a></big></b>
<br>
Let <small>@(@
u_{i,j,k,c}
@)@</small> denote the random effect corresponding to
child index <small>@(@
c
@)@</small>,
rate index <small>@(@
k
@)@</small>,
age index <small>@(@
i
@)@</small> and
time index <small>@(@
j
@)@</small>.

<br>
<br>
<b><big><a name="delta_i,j,k" id="delta_i,j,k">delta_i,j,k</a></big></b>
<br>
We use
<small>@(@
\delta_{i,j,k}^a
@)@</small>
( <small>@(@
\delta_{i,j,k}^t
@)@</small> )
to denote the
<a href="prior_table.htm#std" target="_top"><span style='white-space: nowrap'>std</span></a>
 corresponding to the
<a href="smooth_grid_table.htm#dage_prior_id" target="_top"><span style='white-space: nowrap'>dage_prior_id</span></a>

( <a href="smooth_grid_table.htm#dtime_prior_id" target="_top"><span style='white-space: nowrap'>dtime_prior_id</span></a>
 )
rate index <small>@(@
k
@)@</small>,
age index <small>@(@
i
@)@</small> and
time index <small>@(@
j
@)@</small>.

<br>
<br>
<b><big><a name="d_i,j,k" id="d_i,j,k">d_i,j,k</a></big></b>
<br>
We use
<small>@(@
d_{i,j,k}^a
@)@</small>
( <small>@(@
d_{i,j,k}^t )
@)@</small>
to denote the
<a href="prior_table.htm#density_id" target="_top"><span style='white-space: nowrap'>density_id</span></a>
 and
<a href="prior_table.htm#eta" target="_top"><span style='white-space: nowrap'>eta</span></a>

corresponding to
<a href="prior_table.htm#density_id" target="_top"><span style='white-space: nowrap'>density_id</span></a>
 corresponding to
<a href="smooth_grid_table.htm#dage_prior_id" target="_top"><span style='white-space: nowrap'>dage_prior_id</span></a>

( <a href="smooth_grid_table.htm#dtime_prior_id" target="_top"><span style='white-space: nowrap'>dtime_prior_id</span></a>
 )
rate index <small>@(@
k
@)@</small>,
age index <small>@(@
i
@)@</small> and
time index <small>@(@
j
@)@</small>.


<br>
<br>
<b><big><a name="mu_i,j,k" id="mu_i,j,k">mu_i,j,k</a></big></b>
<br>
We use
<small>@(@
\mu_{i,j,k}^a
@)@</small>
( <small>@(@
\mu_{i,j,k}^t
@)@</small> )
to denote the
<a href="prior_table.htm#mean" target="_top"><span style='white-space: nowrap'>mean</span></a>
 corresponding to the
<a href="smooth_grid_table.htm#dage_prior_id" target="_top"><span style='white-space: nowrap'>dage_prior_id</span></a>

( <a href="smooth_grid_table.htm#dtime_prior_id" target="_top"><span style='white-space: nowrap'>dtime_prior_id</span></a>
 )
rate index <small>@(@
k
@)@</small>,
age index <small>@(@
i
@)@</small> and
time index <small>@(@
j
@)@</small>.
This mean must be zero; see the
child smoothing restrictions.


<br>
<br>
<b><big><a name="Age Differences" id="Age Differences">Age Differences</a></big></b>
<br>
For
<small>@(@
c = 0 , \ldots , C - 1
@)@</small>,
<small>@(@
k = 0 , \ldots , K - 1
@)@</small>,
<small>@(@
i = 0, \ldots , I(k)-2
@)@</small>, and
<small>@(@
j = 0, \ldots , J(k)-1
@)@</small>,
the age difference density for grid index <small>@(@
(i, j)
@)@</small>
and rate index <small>@(@
k
@)@</small> and child index <small>@(@
c
@)@</small> is
<small>@[@

A_{i,j,k,c}^u ( u | \theta )
=
\exp \left[ D \left(
	u_{i+1,j,k,c}    \W{,}
	u_{i,j,k,c}      \W{,}
	\mu_{i,j,k}^a    \W{,}
	\lambda_k^a \delta_{i,j,k}^a \W{,}
	d_{i,j,k}^a
\right) \right]

@]@</small>
where <small>@(@
D
@)@</small> is the
<a href="statistic.htm#Log-Density Function, D.Difference" target="_top"><span style='white-space: nowrap'>difference&nbsp;log-density&nbsp;function</span></a>
.
(As noted above,
<small>@(@
\mu_{i,j,k}^a
@)@</small> must be zero,
<small>@(@
{ d_{i,j,k}^a }:name
@)@</small> must be <code><font color="blue">gaussian</font></code>,
and <small>@(@
{d_{i,j,k}^a}:\eta
@)@</small> does not matter.)

<br>
<br>
<big><a name="Age Differences.A^u" id="Age Differences.A^u">A^u</a></big>
<br>
The age difference density
for the entire random effects vector <small>@(@
u
@)@</small> is defined by
<small>@[@

A^u ( u | \theta )
=
\prod_{c=0}^{C-1} \prod_{k=0}^{K-1} \prod_{i=0}^{I(k)-2} \prod_{j=0}^{J(k)-1}
	A_{i,j,k,c}^u ( u | \theta )

@]@</small>

<br>
<br>
<b><big><a name="Time Differences" id="Time Differences">Time Differences</a></big></b>
<br>
For
<small>@(@
c = 0 , \ldots , C - 1
@)@</small>,
<small>@(@
k = 0 , \ldots , K - 1
@)@</small>,
<small>@(@
i = 0, \ldots , I(k)-1
@)@</small>, and
<small>@(@
j = 0, \ldots , J(k)-2
@)@</small>,
the time difference density for grid index <small>@(@
(i, j)
@)@</small>
and rate index <small>@(@
k
@)@</small> and child index <small>@(@
c
@)@</small> is
<small>@[@

T_{i,j,k,c}^u ( u | \theta )
=
\exp \left[ D \left(
	u_{i,j+1,k,c}    \W{,}
	u_{i,j,k,c}      \W{,}
	\mu_{i,j,k}^t    \W{,}
	\lambda_k^t \delta_{i,j,k}^t \W{,}
	d_{i,j,k}^t
\right) \right]

@]@</small>
where <small>@(@
D
@)@</small> is the difference log density function.
(As noted above,
<small>@(@
\mu_{i,j,k}^t
@)@</small> must be zero,
<small>@(@
{ d_{i,j,k}^t }:name
@)@</small> must be <code><font color="blue">gaussian</font></code>,
and <small>@(@
{ d_{i,j,k}^t }:\eta
@)@</small> does not matter.)

<br>
<br>
<big><a name="Time Differences.T^u" id="Time Differences.T^u">T^u</a></big>
<br>
The time difference density
for the entire random effects vector <small>@(@
u
@)@</small> is defined by
<small>@[@

T^u ( u | \theta )
=
\prod_{c=0}^{C-1} \prod_{k=0}^{K-1} \prod_{i=0}^{I(k)-1} \prod_{j=0}^{J(k)-2}
	T_{i,j,k,c}^u ( u | \theta )

@]@</small>



<hr>Input File: omh/model/random_diff.omh

</body>
</html>
