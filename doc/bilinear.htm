<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>dismod_at Bilinear Interpolation</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="dismod_at Bilinear Interpolation">
<meta name="keywords" id="keywords" content=" dismod_at bilinear interpolation age grid time function interpolant below minimum above maximum outside both limits plotting ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_bilinear_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://bradbell.github.io/dismod_at" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Location-&gt;</option>
<option>dismod_at</option>
<option>model</option>
<option>bilinear</option>
</select>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Search-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td><a href="statistic.htm" target="_top">Prev</a>
</td><td><a href="posterior.htm" target="_top">Next</a>
</td><td>
<script type='text/javascript' language='JavaScript' src='_childtable_dismod_at_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_model_htm.js'></script>
</td>
<td>bilinear</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@



<center><b><big><big>dismod_at Bilinear Interpolation</big></big></b></center>

<br><a href="bilinear.htm#Age Grid" target="_top">Age&nbsp;Grid</a>
<br><a href="bilinear.htm#Time Grid" target="_top">Time&nbsp;Grid</a>
<br><a href="bilinear.htm#Function Grid" target="_top">Function&nbsp;Grid</a>
<br><a href="bilinear.htm#Interpolant" target="_top">Interpolant</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Bilinear" target="_top">Bilinear</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Below Minimum Age" target="_top">Below&nbsp;Minimum&nbsp;Age</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Above Maximum Age" target="_top">Above&nbsp;Maximum&nbsp;Age</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Below Minimum Time" target="_top">Below&nbsp;Minimum&nbsp;Time</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Above Maximum Time" target="_top">Above&nbsp;Maximum&nbsp;Time</a>
<br>&#160;&#160;&#160;&#160;&#160;<a href="bilinear.htm#Interpolant.Outside Both Limits" target="_top">Outside&nbsp;Both&nbsp;Limits</a>
<br><a href="bilinear.htm#Plotting" target="_top">Plotting</a>
<br><br>
<b><big><a name="Age Grid" id="Age Grid">Age Grid</a></big></b>
<br>
We are given a grid of <small>@(@
M
@)@</small> age values
<small>@(@
\{ a_i \; | \; i = 0, \ldots , M-1 \}
@)@</small>.

<br>
<br>
<b><big><a name="Time Grid" id="Time Grid">Time Grid</a></big></b>
<br>
We are also given a grid of <small>@(@
N
@)@</small> time values
<small>@(@
\{ t_j \; | \; j = 0, \ldots , N-1 \}
@)@</small>.

<br>
<br>
<b><big><a name="Function Grid" id="Function Grid">Function Grid</a></big></b>
<br>
In addition,
we are given a grid of function values to be interpolated
<small>@[@

	\left\{
			\left. v_{i,j} = f( a_i , t_j ) \; \right| \;
			i = 0, \ldots , M-1 , j = 0 , \ldots , N-1
	\right\} \; .

@]@</small>

<br>
<br>
<b><big><a name="Interpolant" id="Interpolant">Interpolant</a></big></b>
<br>
The corresponding interpolating function at age <small>@(@
\alpha
@)@</small> and time
<small>@(@
s
@)@</small>, <small>@(@
f( \alpha , s )
@)@</small> is defined as follows:

<br>
<br>
<big><a name="Interpolant.Bilinear" id="Interpolant.Bilinear">Bilinear</a></big>
<br>
Consider the case
where there is an index pair <small>@(@
i < M-1
@)@</small>, <small>@(@
j < N-1
@)@</small> such that
<small>@(@
a_i \leq \alpha \leq a_{i+1}
@)@</small> and
<small>@(@
t_j \leq s \leq t_{j+1}
@)@</small>.
In this case the function is defined by
<small>@[@

f( \alpha , s )
=
\frac{a_{i+1} - \alpha}{a_{i+1} - a_i}
	\frac{t_{j+1} - s}{t_{j+1} - t_j} v_{i,j}
+
\frac{\alpha - a_i}{a_{i+1} - a_i}
	\frac{t_{j+1} - s}{t_{j+1} - t_j} v_{i+1,j}
+
\frac{a_{i+1} - s}{a_{i+1} - a_i}
	\frac{s - t_j}{t_{j+1} - t_j} v_{i+1,j}
+
\frac{\alpha - a_i}{a_{i+1} - a_i}
	\frac{s - t_j}{t_{j+1} - t_j} v_{i+1,j+1}

@]@</small>

<br>
<br>
<big><a name="Interpolant.Below Minimum Age" id="Interpolant.Below Minimum Age">Below Minimum Age</a></big>
<br>
Consider the case where <small>@(@
\alpha < a_0
@)@</small> and
there is an index <small>@(@
j < N-1
@)@</small> such that
<small>@(@
t_j \leq s \leq t_{j+1}
@)@</small>.
In this case the function is defined by
<small>@[@

f( \alpha , s )
=
\frac{t_{j+1} - s}{t_{j+1} - t_j} v_{0,j}
+
\frac{s - t_j}{t_{j+1} - t_j} v_{0,j+1}

@]@</small>

<br>
<br>
<big><a name="Interpolant.Above Maximum Age" id="Interpolant.Above Maximum Age">Above Maximum Age</a></big>
<br>
Consider the case where <small>@(@
a_{M-1} < \alpha
@)@</small> and
there is an index <small>@(@
j < N-1
@)@</small> such that
<small>@(@
t_j \leq s \leq t_{j+1}
@)@</small>.
In this case the function is defined by
<small>@[@

f( \alpha , s )
=
\frac{t_{j+1} - s}{t_{j+1} - t_j} v_{M-1,j}
+
\frac{s - t_j}{t_{j+1} - t_j} v_{M-1,j+1}

@]@</small>

<br>
<br>
<big><a name="Interpolant.Below Minimum Time" id="Interpolant.Below Minimum Time">Below Minimum Time</a></big>
<br>
Consider the case where <small>@(@
s < t_0
@)@</small> and
there is an index <small>@(@
i < M-1
@)@</small> such that
<small>@(@
a_i \leq \alpha \leq a_{i+1}
@)@</small>.
In this case the function is defined by
<small>@[@

f( \alpha , s )
=
\frac{a_{i+1} - \alpha}{a_{i+1} - a_i} v_{i,0}
+
\frac{\alpha - a_i}{a_{i+1} - a_i}  v_{i+1,0}

@]@</small>

<br>
<br>
<big><a name="Interpolant.Above Maximum Time" id="Interpolant.Above Maximum Time">Above Maximum Time</a></big>
<br>
Consider the case where <small>@(@
t_{N-1} < s
@)@</small> and
there is an index <small>@(@
i < M-1
@)@</small> such that
<small>@(@
a_i \leq \alpha \leq a_{i+1}
@)@</small>.
In this case the function is defined by
<small>@[@

f( \alpha , s )
=
\frac{a_{i+1} - \alpha}{a_{i+1} - a_i} v_{i,N-1}
+
\frac{\alpha - a_i}{a_{i+1} - a_i}  v_{i+1,N-1}

@]@</small>

<br>
<br>
<big><a name="Interpolant.Outside Both Limits" id="Interpolant.Outside Both Limits">Outside Both Limits</a></big>

<ol type="1"><li>
If <small>@(@
\alpha < a_0
@)@</small> and <small>@(@
s < t_0
@)@</small>,
<small>@(@
f( \alpha , s ) = v_{0,0}
@)@</small>.
</li><li>

If <small>@(@
\alpha < a_0
@)@</small> and <small>@(@
t_{N-1} < s
@)@</small>,
<small>@(@
f( \alpha , s ) = v_{0,N-1}
@)@</small>.
</li><li>

If <small>@(@
a_{M-1} < \alpha
@)@</small> and <small>@(@
t_{N-1} < s
@)@</small>,
<small>@(@
f( \alpha , s ) = v_{M-1,N-1}
@)@</small>.
</li><li>

If <small>@(@
a_{M-1} < \alpha
@)@</small> and <small>@(@
s < t_0
@)@</small>,
<small>@(@
f( \alpha , s ) = v_{M-1,0}
@)@</small>.
</li></ol>


<br>
<br>
<b><big><a name="Plotting" id="Plotting">Plotting</a></big></b>
<br>
Functions of age and time are usually plotted with
age on the vertical axis and time on the horizontal axis.
This is opposite the usual convention where
the first variable is plotted on the horizontal axis
and the second variable on the vertical axis.


<hr>Input File: omh/model/bilinear.omh

</body>
</html>
