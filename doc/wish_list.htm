<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Dismod_at Wish List</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Dismod_at Wish List">
<meta name="keywords" id="keywords" content=" dismod_at wish list ode solution step size age-time intervals prevalence large excess mortality csv2db command covariate multipliers random effects grids value priors difference sample conditionals checkpointing meas_std diagrams lagrange documentation real world example user examples model sampling special hessian starting point tracing optimization windows install ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_wish_list_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://github.com/bradbell/dismod_at" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Location-&gt;</option>
<option>dismod_at</option>
<option>wish_list</option>
</select>
</td>
<td>
<select onchange='choose_across0(this)'>
<option>Search-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td><a href="whats_new_2015.htm" target="_top">Prev</a>
</td><td>
<select onchange='choose_current0(this)'>
<option>Current-&gt;</option>
<option>ODE Solution</option>
<option>---..Step Size</option>
<option>---..Age-Time Intervals</option>
<option>---..Prevalence ODE</option>
<option>---..Large Excess Mortality</option>
<option>csv2db Command</option>
<option>---..Covariate Multipliers</option>
<option>---..Random Effects</option>
<option>---..Grids</option>
<option>---..Value Priors</option>
<option>---..Difference Priors</option>
<option>---..Sample</option>
<option>---..Conditionals</option>
<option>---..Checkpointing</option>
<option>meas_std</option>
<option>Command Diagrams</option>
<option>Lagrange Multipliers</option>
<option>Documentation</option>
<option>---..Real World Example</option>
<option>---..User Examples</option>
<option>---..Model Documentation</option>
<option>Sampling Random Effects</option>
<option>Special Random Effects Hessian</option>
<option>Random Starting Point</option>
<option>Tracing Optimization</option>
<option>Windows Install</option>
</select>
</td>
<td><a href="_reference.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_down1(this)'>
<option>dismod_at-&gt;</option>
<option>install_unix</option>
<option>get_started</option>
<option>user</option>
<option>database</option>
<option>model</option>
<option>command</option>
<option>python</option>
<option>devel</option>
<option>whats_new_2018</option>
<option>wish_list</option>
</select>
</td>
<td>wish_list</td>
</tr></table><br>
@(@\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\W}[1]{ \; #1 \; }@)@


<center><b><big><big>Dismod_at Wish List</big></big></b></center>
<br>
<b><big><a name="ODE Solution" id="ODE Solution">ODE Solution</a></big></b>


<br>
<br>
<big><a name="ODE Solution.Step Size" id="ODE Solution.Step Size">Step Size</a></big>
<br>
Currently there is a single
<a href="option_table.htm#ode_step_size" target="_top"><span style='white-space: nowrap'>ode_step_size</span></a>
 that is used
for all ages and times.
In many models, the older ages have much larger mortality rates.
Perhaps it would be good to have a step size that varied with age.
The difficulty with this is that it becomes more difficult to solve
on the <a href="ode_grid.htm" target="_top"><span style='white-space: nowrap'>ode_grid</span></a>
 and uses these values to integrate over the
different limits for each data point.
Here is an example of solving on the ODE grid with two step sizes
(the ODE is solved along the diagonals):
<code><font color='blue'><pre style='display:inline'> 
7       x    x    x
       /    /    /
      /    /    /
     /    /    /
    /    /    /
2  /    x    x    x
  /    /    /    /
0/    / x  / x  / x
      1990 1995 2000
</pre></font></code>
Note that when the step size in age matches the step size in time,
the results of the ODE solution at the previous age, time can be used
as initial values for the next integration step.
Also note that, since no ODE needs to be solved for the values
at the initial age, we can make the first age step small without having
to do any extra ODE work.
(There is still software work to deal with the non-uniform grid).

<br>
<br>
<big><a name="ODE Solution.Age-Time Intervals" id="ODE Solution.Age-Time Intervals">Age-Time Intervals</a></big>
<br>
In the special case were a row in the <a href="data_table.htm" target="_top"><span style='white-space: nowrap'>data_table</span></a>
 has

<code><i><font color="black"><span style='white-space: nowrap'>age_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>age_upper</span></font></i></code>
 and

<code><i><font color="black"><span style='white-space: nowrap'>time_lower</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>time_upper</span></font></i></code>
 we should just integrate
the ODE for that specific age, time and not solve for the surrounding
ODE grid points.
For these cases, it would be easier to implement an ODE age step size
that varied with age.


<br>
<br>
<big><a name="ODE Solution.Prevalence ODE" id="ODE Solution.Prevalence ODE">Prevalence ODE</a></big>
<br>
If <small>@(@
S
@)@</small> and <small>@(@
C
@)@</small> satisfy the dismod_at
<a href="avg_integrand.htm#Ordinary Differential Equation" target="_top"><span style='white-space: nowrap'>ordinary&nbsp;differential&nbsp;equation</span></a>
 then prevalence <small>@(@
P = C / (S + C)
@)@</small> satisfies
<small>@[@

	P' = \iota  [ 1 - P ] - \rho P - \chi  [ 1 - P] P

@]@</small>
We can therefore solve for prevalence without other cause mortality
<small>@(@
\omega
@)@</small> or all cause mortality <small>@(@
\omega + \chi P
@)@</small>.
<ol type="1"><li>
The ODE for <small>@(@
P
@)@</small> is non-linear,
while the ODE is <small>@(@
(S, C)
@)@</small> is linear.
</li><li>

All of the current integrands, except for
<a href="avg_integrand.htm#Integrand, I_i(a,t).susceptible" target="_top"><span style='white-space: nowrap'>susceptible</span></a>
 and
<a href="avg_integrand.htm#Integrand, I_i(a,t).withC" target="_top"><span style='white-space: nowrap'>withC</span></a>

can be computed from <small>@(@
P
@)@</small> (given that the rates are inputs to the ODE).
</li><li>

If we know all cause mortality <small>@(@
\alpha = \omega + \chi P
@)@</small>,
once we have solved for <small>@(@
P
@)@</small>,
we can compute <small>@(@
\omega = \alpha - \chi P
@)@</small>.
Furthermore
<small>@[@

	(S + C)' = - \alpha (S + C)

@]@</small>
So we can also compute <small>@(@
S + C
@)@</small>, and
<small>@(@
C = P (S + C)
@)@</small>,
</li><li>

Given the original ODE, we know that the true solution for
<small>@(@
S
@)@</small>, must be positive, and <small>@(@
C
@)@</small>, <small>@(@
P
@)@</small> must be
non-negative.
Negative values for these quantities will correspond to
numerical precision errors in the solution of the ODE.
</li><li>

One advantage of this approach,
over the current approach of solving the ODE in <small>@(@
(S, C)
@)@</small>,
is that the solution is stable as <small>@(@
S + C \rightarrow 0
@)@</small>.
(The current approach computes <small>@(@
P = C / (S + C)
@)@</small>.
</li></ol>


<br>
<br>
<big><a name="ODE Solution.Large Excess Mortality" id="ODE Solution.Large Excess Mortality">Large Excess Mortality</a></big>
<br>
If case where 
<code><i><font color="black"><span style='white-space: nowrap'>rate_case</span></font></i></code>
 is
<a href="option_table.htm#rate_case.iota_pos_rho_zero" target="_top"><span style='white-space: nowrap'>iota_pos_rho_zero</span></a>

corresponds to
<a href="eigen_ode2.htm#Method.Case Three" target="_top"><span style='white-space: nowrap'>case&nbsp;three</span></a>
 in the ODE solver.
If excess mortality <small>@(@
\chi
@)@</small> is unreasonably large,
this can result in exponential overflow and infinity or nan.
It is possible to redo the calculations in case three to properly
handle this condition.

<br>
<br>
<b><big><a name="csv2db Command" id="csv2db Command">csv2db Command</a></big></b>
<br>
The following is a wish list for extending the csv2db command.
This command is only an <a href="csv2db_command.htm#Example" target="_top"><span style='white-space: nowrap'>example</span></a>

intended to help user's get started using dismod_at.

<br>
<br>
<big><a name="csv2db Command.Covariate Multipliers" id="csv2db Command.Covariate Multipliers">Covariate Multipliers</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to include
<a href="avg_integrand.htm#Rate Functions.Rate Covariate Multiplier, alpha_jk" target="_top"><span style='white-space: nowrap'>rate&nbsp;covariate&nbsp;multipliers</span></a>
 and
<a href="avg_integrand.htm#Measurement Value Covariates.Multiplier, beta_j" target="_top"><span style='white-space: nowrap'>measurement&nbsp;value&nbsp;covariate&nbsp;multipliers</span></a>
.

<br>
<br>
<big><a name="csv2db Command.Random Effects" id="csv2db Command.Random Effects">Random Effects</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to include
<a href="avg_integrand.htm#Rate Functions.Child Rate Effect, u_ik" target="_top"><span style='white-space: nowrap'>child&nbsp;rate&nbsp;effects</span></a>
.

<br>
<br>
<big><a name="csv2db Command.Grids" id="csv2db Command.Grids">Grids</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to enable the user to specify
different grids for different model variables.
Currently all the variables use that same
<a href="csv2db_command.htm#mtother.Rectangular Grid" target="_top"><span style='white-space: nowrap'>grid</span></a>
 as the
mtother data.

<br>
<br>
<big><a name="csv2db Command.Value Priors" id="csv2db Command.Value Priors">Value Priors</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to define a specific
<a href="prior_table.htm" target="_top"><span style='white-space: nowrap'>prior</span></a>
 for the value of each
<a href="model_variables.htm" target="_top"><span style='white-space: nowrap'>model&nbsp;variables</span></a>
.
For example, this would enable one to specify limits, or a specific value,
for a model variable.

<br>
<br>
<big><a name="csv2db Command.Difference Priors" id="csv2db Command.Difference Priors">Difference Priors</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to define a specific
<a href="prior_table.htm" target="_top"><span style='white-space: nowrap'>prior</span></a>
 for the differences of the
<a href="model_variables.htm" target="_top"><span style='white-space: nowrap'>model&nbsp;variables</span></a>
; i.e.,
the amount of smoothing.

<br>
<br>
<big><a name="csv2db Command.Sample" id="csv2db Command.Sample">Sample</a></big>
<br>
Extend <a href="csv2db_command.htm" target="_top"><span style='white-space: nowrap'>csv2db_command</span></a>
 to define the
<a href="sample_table.htm" target="_top"><span style='white-space: nowrap'>sample_table</span></a>
.
This would enable csv2db to set up
<a href="predict_command.htm" target="_top"><span style='white-space: nowrap'>predictions</span></a>

using model variables computed by another program.


<br>
<br>
<big><a name="csv2db Command.Conditionals" id="csv2db Command.Conditionals">Conditionals</a></big>
<br>
It is now possible to use conditional expressions in the ODE solution
(CppAD this will now work properly these conditionals
and two levels of AD and revere mode).
This change would remove the need for the
<a href="option_table.htm#rate_case" target="_top"><span style='white-space: nowrap'>rate_case</span></a>
 option.
Note that this will also work with checkpointing.

<br>
<br>
<big><a name="csv2db Command.Checkpointing" id="csv2db Command.Checkpointing">Checkpointing</a></big>
<br>
It should greatly reduce memory if we use
CppAD checkpointing of an ODE that has been
extended to include derivatives with respect to parameters; see
<a href="http://www.coin-or.org/CppAD/Doc/checkpoint_extended_ode.cpp.htm" target="_top"><span style='white-space: nowrap'>checkpoint_extended_ode</span></a>
.

<br>
<br>
<b><big><a name="meas_std" id="meas_std">meas_std</a></big></b>
<br>
Currently the data table
<a href="data_table.htm#meas_std" target="_top"><span style='white-space: nowrap'>meas_std</span></a>

must be specified (except for uniform density).
Perhaps we should allow for this standard deviation to be
<code><font color="blue">null</font></code> in the case when the corresponding
<a href="data_table.htm#meas_value" target="_top"><span style='white-space: nowrap'>meas_value</span></a>
 must not be zero
and the <a href="integrand_table.htm#minimum_meas_cv" target="_top"><span style='white-space: nowrap'>minimum_meas_cv</span></a>

would be used to determine the measurement accuracy.


<br>
<br>
<b><big><a name="Command Diagrams" id="Command Diagrams">Command Diagrams</a></big></b>
<br>
It would be good to give a data flow diagram for each command
that corresponds to its inputs and outputs; i.e., to diagram
the information under the heading
<a href="data_flow.htm#Input and Output by Command" target="_top"><span style='white-space: nowrap'>inputs&nbsp;and&nbsp;outputs&nbsp;by&nbsp;command</span></a>
.

<br>
<br>
<b><big><a name="Lagrange Multipliers" id="Lagrange Multipliers">Lagrange Multipliers</a></big></b>
<br>
Change the Lagrange multipliers
<a href="fit_var_table.htm#lagrange_dage" target="_top"><span style='white-space: nowrap'>lagrange_dage</span></a>
 (dtime) in the
fit_var table to be null when there is no corresponding age (time) different; i.e.,
at the maximum age (time).


<br>
<br>
<b><big><a name="Documentation" id="Documentation">Documentation</a></big></b>


<br>
<br>
<big><a name="Documentation.Real World Example" id="Documentation.Real World Example">Real World Example</a></big>
<br>
It would be good to include a real world example.
Since this is an open source program, we would need a data set
that could be made distributed freely without any restriction on its use.

<br>
<br>
<big><a name="Documentation.User Examples" id="Documentation.User Examples">User Examples</a></big>
<br>
Many of the <a href="user.htm" target="_top"><span style='white-space: nowrap'>user</span></a>
 examples were written a long ago
before certain options were available. It would improve the documentation
to go over the user examples and make them more of a how do to certain
things.

<br>
<br>
<big><a name="Documentation.Model Documentation" id="Documentation.Model Documentation">Model Documentation</a></big>
<br>
There are some subtitle issues in the documentation that perhaps should
be made easier to read. For example,
consider the case where the value and difference priors are
Log-Gaussian or Log-Laplace.
In the function
<a href="fixed_value.htm#V_j" target="_top"><span style='white-space: nowrap'>V_j</span></a>
,
the standard deviation
<a href="fixed_value.htm#delta_j" target="_top"><span style='white-space: nowrap'>delta_j</span></a>
 has the
same units as the corresponding
<a href="prior_table.htm#std" target="_top"><span style='white-space: nowrap'>std</span></a>
 in the <code><font color="blue">prior_table</font></code>.
In the function
<a href="fixed_diff.htm#Age Differences.A^theta" target="_top"><span style='white-space: nowrap'>A^theta</span></a>
,
the standard deviation
<a href="fixed_diff.htm#delta_i,j,k" target="_top"><span style='white-space: nowrap'>delta_j</span></a>
 is a coefficient of variation
for the log of the corresponding values.
This can be seen by noting the difference in the corresponding
weighted residual function; see
Log-Gaussian and Log-Laplace weighted residual functions
<a href="statistic.htm#Weighted Residual Function, R.Log-Gaussian, Log-Laplace, Log-Student's-t" target="_top"><span style='white-space: nowrap'>R</span></a>
.


<br>
<br>
<b><big><a name="Sampling Random Effects" id="Sampling Random Effects">Sampling Random Effects</a></big></b>
<br>
It is not expected that the
<a href="sample_command.htm#method.asymptotic" target="_top"><span style='white-space: nowrap'>asymptotic</span></a>
 statistics for the
random effects will always be accurate
(due to insufficient data for individual random effects).
One could use multiple asymptotic random effects samples as a proposal
density for a Metropolis algorithm to get better sampling of these variables.

<br>
<br>
<b><big><a name="Special Random Effects Hessian" id="Special Random Effects Hessian">Special Random Effects Hessian</a></big></b>
<br>
A new option enables the cppad_mixed user
(in this case dismod_at) to define a special way to compute
the Hessian w.r.t the random effects; see
<a href="https://bradbell.github.io/cppad_mixed/doc/ran_likelihood_hes.htm" target="_top"><span style='white-space: nowrap'>ran_likelihood_hes</span></a>
.

<br>
<br>
<b><big><a name="Random Starting Point" id="Random Starting Point">Random Starting Point</a></big></b>
<br>
Have an option to start at a random point from the prior for the fixed effects
(instead of the mean of the fixed effects).
This would better detect local minima and represent solution uncertainty.

<br>
<br>
<b><big><a name="Tracing Optimization" id="Tracing Optimization">Tracing Optimization</a></big></b>
<br>
Add options to specify the file name for the optimizer trace
at both the fixed and random effects levels.

<br>
<br>
<b><big><a name="Windows Install" id="Windows Install">Windows Install</a></big></b>
<br>
Make and test a set of Windows install instructions for <code><font color="blue">dismod_at</font></code>.


<hr>Input File: omh/wish_list.omh

</body>
</html>
