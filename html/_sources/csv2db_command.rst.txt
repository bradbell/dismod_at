.. _csv2db_command-name:

!!!!!!!!!!!!!!
csv2db_command
!!!!!!!!!!!!!!

xrst input file: ``python/dismod_at/csv2db_command.py``

.. meta::
   :keywords: csv2db_command, conversion, of, a, csv, file, to, a, dismod_at, database

.. index:: csv2db_command, conversion, of, a, csv, file, to, a, dismod_at, database

.. _csv2db_command-title:

Conversion of a Csv File to a Dismod_at Database
################################################

.. meta::
   :keywords: deprecated

.. index:: deprecated

.. _csv2db_command@Deprecated:

Deprecated
**********
This command was deprecated on 2021-12-05.

.. meta::
   :keywords: syntax

.. index:: syntax

.. _csv2db_command@Syntax:

Syntax
******

.. meta::
   :keywords: as, program

.. index:: as, program

.. _csv2db_command@Syntax@As Program:

As Program
==========
``dismodat.py`` *database* *csv2db* *configure_csv* *measure_csv*

.. meta::
   :keywords: as, python, function

.. index:: as, python, function

.. _csv2db_command@Syntax@As Python Function:

As Python Function
==================
``dismod_at.csv2db_command`` ( *database* , *configure_csv* , *measure_csv* )

.. meta::
   :keywords: see, also

.. index:: see, also

.. _csv2db_command@See Also:

See Also
********
:ref:`get_started-name`

.. meta::
   :keywords: example

.. index:: example

.. _csv2db_command@Example:

Example
*******
This command has limited capability and is only meant as an example
to help one get started using dismod_at.
See :ref:`user_csv2db.py-name` for an example that uses this command.

.. meta::
   :keywords: mtall

.. index:: mtall

.. _csv2db_command@mtall:

mtall
*****
The all cause mortality data ``mtall``
in the *measure_csv* file has special meaning.
We assume it has been converted to constraints on other cause
mortality; see :ref:`csv2db_command@mtother` below.
For this reason, it should not be included when fitting,
and is only in *measure_csv* as a check that the desired values
are satisfied (by checking residuals in a data fit).
For this reason, :ref:`csv2db_command@hold_out` must be
one for all the ``mtall`` data; i.e., it is not included during a fit.

.. meta::
   :keywords: mtother

.. index:: mtother

.. _csv2db_command@mtother:

mtother
*******

.. meta::
   :keywords: constraint

.. index:: constraint

.. _csv2db_command@mtother@Constraint:

Constraint
==========
The other cause mortality data ``mtother``
in the *measure_csv* file has special meaning.
It is intended to represent the all cause mortality data
as constraints on other cause mortality in the model.
To be specific, the :ref:`csv2db_command@meas_value`
is a constraint on :math:`\omega` at the corresponding age-time pairs.

.. meta::
   :keywords: age-time, pairs

.. index:: age-time, pairs

.. _csv2db_command@mtother@Age-Time Pairs:

Age-Time Pairs
==============
Each row with *integrand* = ``mtother`` must have
*age_lower* == *age_upper* and
*time_lower* == *time_upper* .

.. meta::
   :keywords: rectangular, grid

.. index:: rectangular, grid

.. _csv2db_command@mtother@Rectangular Grid:

Rectangular Grid
================
The ``mtother`` data must be specified on a rectangular grid; i.e.,
each age that appears, appears in one and only one row for every time
that appears.
This property can also be stated as
each time that appears, appears in one and only one row for every age
that appears.

.. meta::
   :keywords: hold_out

.. index:: hold_out

.. _csv2db_command@mtother@hold_out:

hold_out
========
The :ref:`csv2db_command@hold_out` must be
one for all the ``mtother`` data because
it is a constraint, not data, during a fit.

.. meta::
   :keywords: rate, grid

.. index:: rate, grid

.. _csv2db_command@mtother@Rate Grid:

Rate Grid
=========
All of the
:ref:`non zero rates<csv2db_command@configure_csv@non_zero_rates>`
use the age-time grid corresponding the ``mtother`` data.
In other words, they are modeled as piecewise bilinear between the
age-time points at which ``mtother`` is specified.

.. meta::
   :keywords: predictions

.. index:: predictions

.. _csv2db_command@Predictions:

Predictions
***********
The :ref:`avgint_table-name` is set up so that
:ref:`predictions<predict_command-name>` for the integrands
:ref:`csv2db_command@integrand@Sincidence` ,
:ref:`csv2db_command@integrand@remission` ,
:ref:`csv2db_command@integrand@mtexcess` ,
corresponding to the value of the rates iota, rho, chi on the
:ref:`csv2db_command@mtother@Rectangular Grid` .
Only the non-zero rates are included.
Predictions for
:ref:`csv2db_command@integrand@prevalence` in the
rectangular grid are also included.

.. meta::
   :keywords: database

.. index:: database

.. _csv2db_command@database:

database
********
This argument
is an ``str`` containing the name of the dismod_at database
file that is written by this command.

.. meta::
   :keywords: configure_csv

.. index:: configure_csv

.. _csv2db_command@configure_csv:

configure_csv
*************
This argument
is an ``str`` containing the configuration file name and must
end with the ``.csv`` extension.
The first row contains the following column names
``name`` , ``value`` .
Column names that begin with ``c_`` are comments
and will not be used by future versions of ``csv2db`` .
The configuration options are documented by the corresponding
name below.

.. meta::
   :keywords: non_zero_rates

.. index:: non_zero_rates

.. _csv2db_command@configure_csv@non_zero_rates:

non_zero_rates
==============
The *value* in this row is a list rates that are non-zero
in the model.
The possible rates are
``pini`` , ``iota`` , ``rho`` , ``chi`` , ``omega`` .
The rates in the list are separated by a single space
and ``omega`` must appear in the list.
There is no default value for this value; i.e., it must appear.

.. meta::
   :keywords: measure_csv

.. index:: measure_csv

.. _csv2db_command@measure_csv:

measure_csv
***********
is an ``str`` containing the data file name
and must end with the ``.csv`` extension.
Each row of the data file corresponds to one data point.
The first row of the file contains the column names.
The other rows correspond to data points.
Each column of the necessary columns in the data file is documented
under its column name below.
Column names that begin with ``c_`` are comments
and will not be used by future versions of ``csv2db`` .

.. meta::
   :keywords: integrand

.. index:: integrand

.. _csv2db_command@integrand:

integrand
*********
This column of *measure_csv* contains
one of the valid integrands:

.. meta::
   :keywords: sincidence

.. index:: sincidence

.. _csv2db_command@integrand@Sincidence:

Sincidence
==========
The incidence rate relative to susceptible population:
:math:`\iota`.

.. meta::
   :keywords: remission

.. index:: remission

.. _csv2db_command@integrand@remission:

remission
=========
The remission rate:
:math:`\rho`.

.. meta::
   :keywords: mtexcess

.. index:: mtexcess

.. _csv2db_command@integrand@mtexcess:

mtexcess
========
The excess mortality rate:
:math:`\chi`.

.. meta::
   :keywords: mtother

.. index:: mtother

.. _csv2db_command@integrand@mtother:

mtother
=======
The other cause mortality rate:
:math:`\omega`.

.. meta::
   :keywords: mtwith

.. index:: mtwith

.. _csv2db_command@integrand@mtwith:

mtwith
======
The with condition mortality rate:
:math:`\omega + \chi`.

.. meta::
   :keywords: susceptible

.. index:: susceptible

.. _csv2db_command@integrand@susceptible:

susceptible
===========
The susceptible fraction of the population:
:math:`S`.

.. meta::
   :keywords: withc

.. index:: withc

.. _csv2db_command@integrand@withC:

withC
=====
The with condition fraction of the population:
:math:`C`.

.. meta::
   :keywords: prevalence

.. index:: prevalence

.. _csv2db_command@integrand@prevalence:

prevalence
==========
The prevalence of the condition:
:math:`P = C / [ S + C ]`.

.. meta::
   :keywords: tincidence

.. index:: tincidence

.. _csv2db_command@integrand@Tincidence:

Tincidence
==========
The incidence rate relative to the total population:
:math:`\iota [ 1 - P ]`.

.. meta::
   :keywords: mtspecific

.. index:: mtspecific

.. _csv2db_command@integrand@mtspecific:

mtspecific
==========
The cause specific mortality rate:
:math:`\chi P`.

.. meta::
   :keywords: mtall

.. index:: mtall

.. _csv2db_command@integrand@mtall:

mtall
=====
The all cause mortality rate:
:math:`\omega + \chi P`.

.. meta::
   :keywords: mtstandard

.. index:: mtstandard

.. _csv2db_command@integrand@mtstandard:

mtstandard
==========
The standardized mortality ratio:
:math:`[ \omega + \chi ] / [ \omega + \chi P ]`.

.. meta::
   :keywords: relrisk

.. index:: relrisk

.. _csv2db_command@integrand@relrisk:

relrisk
=======
The relative risk:
:math:`[ \omega + \chi ] / \omega`.

.. meta::
   :keywords: age_lower

.. index:: age_lower

.. _csv2db_command@age_lower:

age_lower
*********
This column of *measure_csv* contains
The initial age for averaging the integrand for this row; :math:`b`.

.. meta::
   :keywords: age_upper

.. index:: age_upper

.. _csv2db_command@age_upper:

age_upper
*********
This column of *measure_csv* contains
the final age for averaging the integrand for this row; :math:`c`.

.. meta::
   :keywords: time_lower

.. index:: time_lower

.. _csv2db_command@time_lower:

time_lower
**********
This column of *measure_csv* contains
the initial time for averaging the integrand for this row; :math:`r`.

.. meta::
   :keywords: time_upper

.. index:: time_upper

.. _csv2db_command@time_upper:

time_upper
**********
This column of *measure_csv* contains
the final time for averaging the integrand for this row; :math:`s`.

.. meta::
   :keywords: meas_value

.. index:: meas_value

.. _csv2db_command@meas_value:

meas_value
**********
This column of *measure_csv* contains
the value of the average integrand plus measurement noise

.. math::

 e + \frac{1}{c-b} \frac{1}{s-r} \int_b^c \int_r^s I(a , t) \; da \; dt

where :math:`e` is the measurement noise,
:math:`a` and :math:`t` are the age and time integration variables,
and :math:`I(a, t)` is the value of the integrand for this row.

.. meta::
   :keywords: meas_std

.. index:: meas_std

.. _csv2db_command@meas_std:

meas_std
********
This column of *measure_csv* contains
the standard deviation of the measurement noise :math:`e`.

.. meta::
   :keywords: hold_out

.. index:: hold_out

.. _csv2db_command@hold_out:

hold_out
********
This column of *measure_csv* contains
either zero or one. If it is one, this row is included
dismod_at fits. Otherwise it is excluded.
In either case, the residuals are computed for this row.
