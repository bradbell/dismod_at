.. _user_subgroup_mulcov.py-name:

!!!!!!!!!!!!!!!!!!!!!!!
user_subgroup_mulcov.py
!!!!!!!!!!!!!!!!!!!!!!!

xrst input file: ``example/user/subgroup_mulcov.py``

.. meta::
   :keywords: user_subgroup_mulcov.py, example, fitting, with, subgroup, covariate, multipliers

.. index:: user_subgroup_mulcov.py, example, fitting, with, subgroup, covariate, multipliers

.. _user_subgroup_mulcov.py-title:

Example Fitting With Subgroup Covariate Multipliers
###################################################

.. meta::
   :keywords: node, table

.. index:: node, table

.. _user_subgroup_mulcov.py@Node Table:

Node Table
**********
The following is a diagram of the node tree for this example:
::

         p1
        /  \
       c1  c2

.. meta::
   :keywords: subgroup, table

.. index:: subgroup, table

.. _user_subgroup_mulcov.py@Subgroup Table:

Subgroup Table
**************
The following is a diagram of the subgroup tree for this example:
::

           p1
          /  \
        g1   none
       /  \    \
      s1   s2  none

.. meta::
   :keywords: model, variables

.. index:: model, variables

.. _user_subgroup_mulcov.py@Model Variables:

Model Variables
***************

.. meta::
   :keywords: parent, rates

.. index:: parent, rates

.. _user_subgroup_mulcov.py@Model Variables@Parent Rates:

Parent Rates
============
There is an iota
:ref:`parent rate<model_variables@Fixed Effects, theta@Parent Rates>`
corresponding to node p1.
This variable has a uniform prior.

.. meta::
   :keywords: group, covariate, multiplier

.. index:: group, covariate, multiplier

.. _user_subgroup_mulcov.py@Model Variables@Group Covariate Multiplier:

Group Covariate Multiplier
==========================
There is a
:ref:`group covariate multiplier<model_variables@Fixed Effects, theta@Group Covariate Multipliers>`
that affects all the data in group g1.
This variable has a uniform prior.

.. meta::
   :keywords: child, rate, effects

.. index:: child, rate, effects

.. _user_subgroup_mulcov.py@Model Variables@Child Rate Effects:

Child Rate Effects
==================
There are two
:ref:`model_variables@Random Effects, u@Child Rate Effects`
one for the data corresponding to child c1,
the other for child c2.
These variables have gaussian priors with mean zero and standard deviation
100 times the absolute true child rate effect.

.. meta::
   :keywords: subgroup, covariate, multiplier

.. index:: subgroup, covariate, multiplier

.. _user_subgroup_mulcov.py@Model Variables@Subgroup Covariate Multiplier:

Subgroup Covariate Multiplier
=============================
There are two
:ref:`model_variables@Random Effects, u@Subgroup Covariate Multipliers`
one for the data corresponding to subgroup s1,
the other for subgroup s2.
These variables have gaussian priors with mean zero and standard deviation
100 times the absolute true subgroup effect.

.. meta::
   :keywords: rate, table

.. index:: rate, table

.. _user_subgroup_mulcov.py@Rate Table:

Rate Table
**********
There is one entry in the rate table that
specifies the iota smoothing for the parent node p1.
There is another entry that specifies the iota smoothing
for the child nodes c1, c2.

.. meta::
   :keywords: mulcov, table

.. index:: mulcov, table

.. _user_subgroup_mulcov.py@Mulcov Table:

Mulcov Table
************
There is one entry in the mulcov table for group g1 and
the two subgroups s1, s1 (that make up g1).
The group smoothing is used for the fixed effect corresponding to g1
and the subgroup smoothing is used for the s1, s2 random effects.

.. meta::
   :keywords: data, table

.. index:: data, table

.. _user_subgroup_mulcov.py@Data Table:

Data Table
**********
Each child (c1, c2) and each subgroup (s1, s2, none)
have a corresponding data point that is simulated without any noise.

.. meta::
   :keywords: problem, parameters

.. index:: problem, parameters

.. _user_subgroup_mulcov.py@Problem Parameters:

Problem Parameters
******************

.. literalinclude:: ../../example/user/subgroup_mulcov.py
   :lines: 92-96
   :language: py

.. meta::
   :keywords: source, code

.. index:: source, code

.. _user_subgroup_mulcov.py@Source Code:

Source Code
***********

.. literalinclude:: ../../example/user/subgroup_mulcov.py
   :lines: 112-383
   :language: py
